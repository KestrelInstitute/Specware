#!/bin/sh
# this is bin/mkgrammar
self=mkgrammar

ARCH=unknown
if [ -x /bin/uname ]
then ARCH=`/bin/uname -p`
fi
if [ "$ARCH" = unknown -a -x /bin/arch ]
then ARCH=`/bin/arch -p`
fi
if [ "$ARCH" = unknown -a -x /usr/local/bin/arch ]
then ARCH=`/usr/local/bin/arch -p`
fi
if [ "$ARCH" = unknown ]
then echo "$self: no uname/arch program found" >&2
     exit 1
fi

LHOME=`echo echo ~lambert | sh`
abc=$LHOME/bin/$ARCH/abc-bin
LABC=$LHOME/abc

if [ ! -r $abc ]
then /bin/echo "$self: cannot run abc here" 2>&1
     /bin/echo abc = $abc
     exit 0
fi

if [ ! -r $LABC/meta/glmgramm.cmd ]
then /bin/echo "$self: no GLMGRAMMAR here" 2>&1
     exit 0
fi

(/bin/cat grammar.preamble
 (/bin/echo GLMGRAMMAR; /bin/cat metaslang.glm; /bin/echo ZeEnd) |
  $abc -g $LABC -w meta
  /bin/echo '</appendix>'
) > grammar.glm
