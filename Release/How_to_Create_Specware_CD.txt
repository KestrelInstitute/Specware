How to Create a Specware 4.1.4 CD

Last updated:Mon Nov 21, 2005, by JLM

This assumes "here" is the machine named Core-Win
(currently in the third office from the front stairs).

The step order is as follows:

First these:  Windows-A/B/C/D/E/F/G  [A/B/C/D on Windows machine, E/F/G here]
                                     [The Windows machine can be here]

                Linux-A/B/C/D/E/F/G  [A/B/C/D on Linux   machine, E/F/G here]

                  Mac-A/B/C/D/E/F/G  [A/B/C/D on Mac     machine, E/F/G here] 

Then these:   CD-A/B/C               [here]

Then these:   TEST and TAG-CVS       [here]

STEP Windows-A: Uninstall previous Specware (if necessary)

  1. Go to Start -> Settings -> Control Panels

  2. Double-click Add/Remove Programs

  3. Scroll down to Specware4.1 (or similar) and click Change/Remove

  4. Click ok to uninstall Specware

STEP Windows-B: Do CVS updates for Specware

  1. Open WinCVS (Start -> Programs -> WinCVS -> WinCVS)

  2. Update the Specware4 development directory (C:\Specware4)


STEP Windows-C:  Build Specware

  1. Go to C:\Specware4\Applications\Specware\bin\windows
    
  Either:

  2. Double-click build.cmd
     wait for the message "It is safe to exit"
     exit from lisp

  3. Double-click bootstrap.cmd
     wait for the message "It is safe to exit"
     exit from lisp

  Or:

  2. Double-click Specware4.cmd. 

  3. If XEmacs doesn't start up and try to load Specware, edit Specware4.cmd to
     ensure that the XEmacs variable is set correctly for your system. 

  4. If this was a fresh check-out, and you are asked, 
       "Continue waiting for ACL to startup (y/n)?" 
     answer 
       'n'.

  5. Do M-x build-specware4-from-base
     wait for the message "It is safe to exit"
     do not exit from lisp

  6. Do M-x bootstrap-specware4
     wait for the message "It is safe to exit"
     exit from lisp

STEP Windows-D: Start Specware, and create the Allegro distribution directory

  1. Go to C:\Specware4\Applications\Specware\bin\windows

  2. Double-click Specware4.cmd

  3. Possibly: Edit C:\Specware4\Applications\Specware\Handwritten\Lisp\BuildDistribution_ACL.lisp 
               Set Specware-name, Specware-version, Specware-version-name as appropriate.

  4. In the "*Specware Shell*" buffer, type:

    cd C:/Specware4/Applications/Specware/Handwritten/Lisp
    ld BuildDistribution_ACL.lisp

    We should now have a distribution directory under 
      C;/SpecwareReleases/Specware-4-1-4/Windows/Specware4/

     containing the Allegro stuff needed to run Specware as a stand-alone application,
     as well as some necessary subdirs (e.g. Documentation, Example, Library, etc.).  
     (This directory will provide input to InstallShield.)
    We should now have Linux/Spcware4 and Windows/Specware4 dirs containing
     pre-InstallShield build results.
    We should also have a CD directory with some installation scripts on it, plus 
     some some empty dirs (to be filled later with the results of InstallShield).
    You should see this message:

    ;;; Current status of release directory:
    ;;;
    ;;; C:/SpecwareReleases/Specware-4-1-4/
    ;;; -----------------------------------
    ;;;  CD\Autorun.inf
    ;;;     InstallOnLinux
    ;;;     InstallOnMac
    ;;;     InstallOnWindows.cmd
    ;;;     Linux\Specware4\                [ 0 files]
    ;;;     Mac\Specware4\                  [ 0 files]
    ;;;     Windows\Specware4\              [ 0 files]
    ;;;  Linux\Specware4\Documentation\     [ 4 files]
    ;;;                  Examples\          [ 4 files]
    ;;;                  Languages\         [ 1 files]
    ;;;                  Library\           [ 6 files]
    ;;;                  Patches\           [ 0 files]
    ;;;                  Specware
    ;;;                  Specware4.cmuimage
    ;;;                  SpecwareShell
    ;;;  Windows\Specware4\acli701.dll
    ;;;                    check-and-set-environment.cmd
    ;;;                    Documentation\   [ 4 files]
    ;;;                    Examples\        [ 4 files]
    ;;;                    Languages\       [ 1 files]
    ;;;                    Library\         [ 6 files]
    ;;;                    Patches\         [ 0 files]
    ;;;                    Specware4 Shell.cmd
    ;;;                    Specware4.cmd
    ;;;                    Specware4.dxl
    ;;;                    Specware4.exe
    ;;;                    Specware4.lic
    ;;;                    StartShell.lisp
    ;;;                    system-dlls\     [ 1 files]

STEP Windows-E: Copy the Windows files to here 

      This is a no-op: the Windows files are already here.

STEP Windows-F: Create the InstallShield package for Windows installation

  1. Open InstallShield (Start -> Programs -> 
                         InstallShield -> 
                         InstallShield 10.5 Tools -> 
                         InstallShield 10.5 Universal IDE)

  2. If Specware project already exists:

       Click on Specware-4-1-4-Windows.uip in main InstallShield window

     else:

       Click on "Create a new project..." in the left side panel.
       Click on "Universal Installer Project"
       Enter "Project Name:" as "Specware-4-1-4-Windows"
       Enter "Location:" as 
        "C:\Documents and Settings\core\My Documents\InstallShield X Universal Projects\"


  3. Click on "Project Assistant", then step through the following stages:

        Application Information:    

            Kestrel
            Specware
            4.1.4
            www.specware.com

        Installation Requirements: 

            Windows Platform support

        Installation Architecture:

            Specware
              - Feature 1

        Application Files:

            Specware4  => C:/SpecwareReleases/Specware-4-1-4/Windows/Specware4

        Application Launchers:   <none>

        Application Shortcuts:

          Make four entries (two copies of each)

           Specware4            => $P(absoluteInstallLocation)/Specware4.cmd        C:/Specware4/Release/Windows/S.ico
           Specware4            => $P(absoluteInstallLocation)/Specware4.cmd        C:/Specware4/Release/Windows/S.ico
           Specware4 (no_Emacs) => $P(absoluteInstallLocation)/Specware4 Shell.cmd  C:/Specware4/Release/Windows/S.ico
           Specware4 (no_Emacs) => $P(absoluteInstallLocation)/Specware4 Shell.cmd  C:/Specware4/Release/Windows/S.ico

          Switch to "Installation Designer"
             
          In "View List" window at left, right-click, then "Expand All"
          Select "Shortcuts"                          

          In middle "Explorer" window
          Select the first "Specware4", then edit its properties in window at right:

             Standard Properties:
                Active             true
                Display Name       Specware4
                Folder             $P(displayName)  [or $P(bean5.displayName) etc.]
                Name               Specware4
		Target             $P(absoluteInstallationLocation)/Specware4.cmd

             Open platform-Specific Properites
             Scroll down to "Windows"
             Turn on with "Enable", then
                Foldercontext             Program Menu for All Users
                Icon                      C:/Specware4/Release/Windows/S.ico
                Icon file type            Bundled
                Platform Specific Targer  <blank>

          Select the second "Specware4" and edit its properties in window at right:

             Standard Properites:
                Active             true
                Display Name       Specware4
                Folder             
                Name               Specware4
		Target             $P(absoluteInstallationLocation)/Specware4.cmd

             Open platform-Specific Properites
             Scroll down to "Windows"
             Turn on with "Enable", then
                Foldercontext             Desktop for All Users
                Icon                      C:/Specware4/Release/Windows/S.ico
                Icon file type            Bundled
                Platform Specific Targer  <blank>

          Select the first "Specware4 (no Emacs)" and edit its properties in window at right:

             Standard Properites:
                Active             true
                Display Name       Specware4 (no Emacs)
                Folder             $P(displayName)       [or $P(bean5.displayName) etc.]
                Name               Specware4 (no Emacs)
		Target             $P(absoluteInstallationLocation)/Specware4 Shell.cmd

             Open platform-Specific Properites
             Scroll down to "Windows"
             Turn on with "Enable", then
                Foldercontext             Program Menu for All Users
                Icon                      C:/Specware4/Release/Windows/S.ico
                Icon file type            Bundled
                Platform Specific Targer  <blank>


          Select the second "Specware4 (no Emacs)" and edit its properties in window at right:

             Standard Properites:
                Active             true
                Display Name       Specware4 (no Emacs)
                Folder             
                Name               Specware4 (no Emacs)
		Target             $P(absoluteInstallationLocation)/Specware4 Shell.cmd

             Open platform-Specific Properites
             Scroll down to "Windows"
             Turn on with "Enable", then
                Foldercontext             Desktop for All Users
                Icon                      C:/Specware4/Release/Windows/S.ico
                Icon file type            Bundled
                Platform Specific Targer  <blank>

        Return to the Project Assistant

        Installation Interview:

           "Yes" to "Do you wnat the user to be shown a license agreement?"
                    License Agreement File:  C:/Specware4/Release/WindowsLicense.txt

           "Yes" to "Do you want your users to be prompted to modify...?"

           "No"  to "Do you want users to be able to selectively install parts of your application?"

        Build Installation:

           Select "CD-ROM"

           Maybe select "Run Installer after Build"  (optional)

           Click on "Build Installation"

           ============================================        
           If you selected "Run Installer after Build" then InstallShield 
           will prompt to install Specware on this machine.  
           ============================================        

STEP Windows-G: Copy the installation to the CD directory

  1.  Still within InstallShield, go to (Tools -> Open Release Folder)

  2.  Double-click on dsk1 to open it.

  3.  Copy everything from the resulting window (currently eight files).

  4.  Paste everything into C:\SpecwareReleases\Specware-4-1-4\CD\Windows\Specware4\
      [This dir was prepared in step Windows-D.4 by BuildDistribution_ACL.cmd]


STEP Linux-A/B/C/D: Prepare CMUlisp files

  1.  Have Stephen Westfold or Jim McDonald build Specware on a Linux machine.
      (Similar to steps Windows-A/B/C/D, but on Linux)

STEP Linux-E: Copy the CMULisp files to here

  1.  Copy the resulting Linux files 
       from unix location such as
            \\Unix-homedirs\Kestrel\mcdonald\Specware4\distribution-cmulisp
         to C:\SpecwareReleases\Specware-4-1-4\Linux\Specware4\

STEP Linux-F: Create the InstallShield package for Linux installation 

  1.  Open InstallShield (Start -> Programs -> 
                          InstallShield -> 
                          InstallShield 10.5 Tools -> 
                          InstallShield 10.5 Universal IDE)

  2.  If Specware project already exists:

       Click on Specware-4-1-4-Linux.uip in main InstallShield window

      else:

       Click on "Create a new project..." in the left side panel.
       Click on "Universal Installer Project"
       Enter "Project Name:" as "Specware-4-1-4-Linux"
       Enter "Location:" as 
        "C:\Documents and Settings\core\My Documents\InstallShield X Universal Projects\"


  3. Click on "Project Assistant", then step through the following stages:

        Application Information:    

            Kestrel
            Specware
            4.1.4
            www.specware.com

        Installation Requirements: 

            Linux Platform support

        Installation Architecture:

            Specware
              - Feature 1

        Application Files:

            Specware4     => C:/SpecwareReleases/Specware-4-1-4/Linux/Specware4
            Specware      => C:/SpecwareReleases/Specware-4-1-4/Linux/Specware4/Specware
            SpecwareShell => C:/SpecwareReleases/Specware-4-1-4/Linux/Specware4/SpecwareShell

            Then select (Installation Designer -> Application Data ->  Files).
            For both Specware and SpecwareShell, select (Edit -> Attributes)
            and then select Execute for Owner/Group/World.
            Then return to Project Assistant
      
        Application Launchers:   <none>

        Application Shortcuts:   <none>

        Return to the Project Assistant

        Installation Interview

           "Yes" to "Do you wnat the user to be shown a license agreement?"
                    License Agreement File:  C:/Specware4/Release/License.txt

           "Yes" to "Do you want your users to be prompted to modify...?"

           "No"  to "Do you want users to be able to selectively install parts of your application?"


        Build Installation

           Select "CD-ROM"

           Click on "Build Installation"

STEP Linux-G: Copy the Linux installation to the CD directory          

  1. Still within InstallShield, go to (Tools -> Open Release Folder)

  2. Double-click on dsk1 to open it.

  3. Copy everything from the resulting window (currently three files).

  4. Paste everything into C:\SpecwareReleases\Specware-4-1-4\CD\Linux\Specware4\


STEP Mac-A/B/C/D: Prepare CMUlisp files

  1.  Have Stephen Westfold build Specware on a Mac machine.
      (Similar to steps Windows-A/B/C/D, but on Mac)

STEP Mac-E: Copy the CMULisp files to here

  2.  Copy the resulting Mac files from <wherever they are> 
                                     to C:\SpecwareReleases\Specware-4-1-4\Mac\Specware4\

STEP Mac-F: Create the InstallShield package for Windows installation 

   Similar to step Linux-E, but select Specware-4-1-4-Mac.uip

STEP Mac-G: Copy the Mac installation to the CD directory          

  1. Still withing InstallShield, go to (Tools -> Open Release Folder)

  2. Double-click on dsk1 to open it.

  3. Copy everything from the resulting window (currently eight files).

  4. Paste everything into C:\SpecwareReleases\Specware-4-1-4\CD\Mac\Specware4\


STEP CD-A: CREATE LABEL

  1. Create a CD label using PowerPoint and/or Paintshop.  
     Include "Specware", the release date, version, type of release (e.g., Windows and Linux), 
     and the copyright jabber.

  2. Use the CD LabelMaker software to insert a jpg into the label template.

  3. Insert a sheet of the label stickers into P6200, with the label side up.  Print to P6200.

STEP CD-B: Burn the CD

  1. Insert a blank CD into the PlexWriter drive on Core-Win.

  2. Open Nero (Start -> Programs -> Ahead Nero -> Nero - Burning Rom)

  3. Click  Next, Next, Next, Next, Finish  through the first wizard that pops up.

  4. In the right side window labeled File Browser, move to C:\SpecwareReleases\Specware-4-1-4\CD

  5. Copy everything in this directory, and paste it into the left side window labeled ISO1.

  6. Copy the XEmacs installation folder (I put it on the Desktop for now) to the top level of the CD.

  7. Rename the CD from NEW to Specware-4-1-4 by right-clicking the NEW label in the leftmost panel 
     and selecting Rename.

  8. Go to (File -> Write CD), and then click Burn in the window that pops up.

  9. Wait. 
     Click Done when the burning process is completed.  
     Nero can then be closed without saving anything.

STEP CD-C:: Stick the label on the CD

  1. Stick the label sticky-side up on the purple thing.

  2. Put the CD upside down on top of the label on the purple thing.

  3. Press the black thing in the middle down firmly.

  4. Take the CD off and make sure the label is fully adhered to the CD.


STEP Test

  1. Install Specware 4.1.4

  2. Run the examples & tests.

STEP TAG-CVS

   Tag the sources in CVS with the release version (rel-4-1-4)
   See http://intranet/specware/intranet/cvs-cheatsheet.html 

For Help:

 - Find Jim McDonald or Stephen Westfold for content, 
   or Jeff Kitson for system stuff.
   Call Jim at 408-204-6209 (Cell phone with voice mail)
