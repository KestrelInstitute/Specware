How to Create a Specware 4.1.4 CD (with XEmacs & for Windows)

Last updated: Nov 17, 2005, by JLM

STEP A: Uninstall previous Specware (if necessary)

  1.  Go to Start -> Settings -> Control Panels

  2.  Double-click Add/Remove Programs

  3.  Scroll down to Specware4.1 (or similar) and click Change/Remove

  4.  Click ok to uninstall Specware.

STEP B: Do CVS updates for Specware

 1. Open WinCVS (Start -> Programs -> WinCVS -> WinCVS)

 2. Update the Specware4 development directory (C:\Specware4)


STEP C:  Build Specware

 1. Go to C:\Specware4\Applications\Specware\bin\windows
    Double-click Specware4.cmd. 

 2. If XEmacs doesn't start up and try to load Specware, edit Specware4.cmd to
    ensure that the XEmacs variable is set correctly for your system. 

 3. If this was a fresh check-out, and you are asked, 
      "Continue waiting for ACL to startup (y/n)?" 
    answer 
      'n'.

 4. Do M-x build-specware4-from-base

 5. Do M-x bootstrap-specware4

STEP D: Start Specware, and create the Allegro distribution directory

 0. Delete the directory C:\SpecwareReleases\Specware-4-1-4\Specware\distribution-Allegro
    if it already exists

 1. Go to C:\Specware4\Applications\Specware\bin\windows

 2. Double-click Specware4.cmd

 3. Possibly:
      Open C:\Specware4\Applications\Specware\Handwritten\Lisp\BuildDistribution.lisp 
       for editing in XEmacs.
      Set Specware-name, Specware-version, Specware-version-name as appropriate.

 4. In the "*Specware Shell*" buffer, type:

    [
     To get around an allegro bug you may have to do
      ld c:\Program Files\acl62\code\build
      ld c:\Program Files\acl62\code\genapp
    ]

    :cd /Specware4/Applications/Specware/Handwritten/Lisp
    :ld BuildDistribution.lisp

    [This should create a distribution directory under Specware4/... that contains 
     the Allegro stuff needed to run Specware as a stand-alone application, as well 
     as the necessary subdirectories (e.g. Documentation, Example, Library, etc.).  
    Stephen Westfold wrote BuildRuntime.lisp and knows more.


(STEP pre-E): Copy the distribution directory to where InstallShield is expecting it

  1. Copy the Specware4 directory under C:\Specware4\distribution\, 

  2  Paste it into C:\SpecwareReleases\Specware-4-1-4\Specware\distribution-Allegro\Windows.

     (TODO: fix the lisp function to do this automatically in BuildRuntime) 
     Copy and rename 
       C:\Specware4\Release\Windows\Patches\empty-patch-template.fasl 
     to   
       C:\SpecwareReleases\Specware-4-1-4\Specware\distribution-Allegro\Windows\Specware4\Patches\

STEP E: Create the InstallShield package

  1.  Open InstallShield (Start -> Programs -> InstallShield -> Developer)

  2. Either:

       Click on "Create a new project..." in the left side panel.
       Click on "Universal Installer Project"
       Enter "Project Name:" as "Specware-4-1-4-Windows"
       Enter "Location:" as 
        "C:\Documents and Settings\core\My Documents\InstallShield X Universal Projects\"

     Or (if Specware project already exists):

       Click on Specware-4-1-4-Windows.uip in main InstallShield window

  3. Click on "Project Assistant", then step through the following stages:

        Application Information:    

              Kestrel
              Specware4
              4.1.4
              www.specware.com

        Installation Requirements: 

              Windows Platform support

        Installation Architecture:

              Specware
              - Feature 1

        Application Files:

              Specware.cmd        => C:/SpecwareReleases/Specware-4-1-4/Windows/Specware.cmd
              Specware Shell.cmd  => C:/SpecwareReleases/Specware-4-1-4/Windows/Specware Shell.cmd

        Application Launchers:

              <none>

        Application Shortcuts:

              Specware            => $P(absoluteInstallLocation)/Specware.cmd
              Specware Shell      => $P(absoluteInstallLocation)/Specware Shell.cmd

        Application Interview:

              "Yes" to "Do you wnat the user to be shown a license agreement?"
              License Agreement File:  C:/SpecwareReleases/Specware-4-1-4/Windows/ClickThruSpecwareLicense.lic

        Build Installattion:

              "Single Executable"         
              "Run Installer after Build"  (optional)

        Click on "Build Installation"

        ============================================        
        If you selected "Run Installer after Build" then InstallShield 
        will prompt to install Specware on this machine.  
        ============================================        


STEP F: Copy the installation to the CD directory

  1. Go to Tools -> Open Release Folder.  

  2. Copy everything in the window that pops up.  

  3. Paste everything into C:\SpecwareReleases\Specware-4-1-4\Specware\Windows\CD\

  4. Edit C:\SpecwareReleases\Specware-4-1-4\Specware\Windows\CD\Autorun.inf 
     to point to Windows/setup.exe instead, and move Autorun.inf up one level to 
     C:\SpecwareReleases\Specware-4-1-4\Specware\Windows\CD 
     so that Windows will find it when the CD is inserted into the user's machine.


     *** To add a shortcut, right-click "Desktop" and select "New shortcut to preexisting file". 
         Type "Specware4.cmd" as the filename. 
         Add a second shortcut to the same file under "Taskbar/Start Menu/Programs Menu".  
         Rename both shortcut names as "Specware 4.1".


STEP G: Copy CMUlisp files over to Windows

  1.  Talk to Stephen Westfold or Jim McDonald and ask them to build Specware on a Linux machine.

  2.  Copy Linux files from J:\<wherever they are> 
                         to C:\SpecwareReleases\Specware-4-1-4\CD\Linux\

STEP H: CREATE LABEL

  1. Create a CD label using PowerPoint and/or Paintshop.  
     Include "Specware", the release date, version, type of release (Windows and Linux), 
     and the copyright jabber.

  2. Use the CD LabelMaker software to insert a jpg into the label template.

  3. Insert a sheet of the label stickers into P6200, with the label side up.  Print to P6200.

STEP I: Burn the CD

  1. Insert a blank CD into the PlexWriter drive on Core-Win.

  2. Open Nero (Start -> Programs -> Ahead Nero -> Nero - Burning Rom)

  3. Click Next, Next, Next, Next, Finish through the first wizard that pops up.

  4. In the right side window labeled File Browser, move to C:\SpecwareReleases\Specware-4-1-4\Specware\Windows\CD

  5. Copy everything in this directory, and paste it into the left side window labeled ISO1.

  6. Copy the XEmacs installation folder (I put it on the Desktop for now) to the top level of the CD.

  7. Rename the CD from NEW to Specware-4-1-4 by right-clicking the NEW label in the leftmost panel and selecting Rename.

  8. Go to File -> Write CD, and then click Burn in the window that pops up.

  9. Wait. 
     Click Done when the burning process is completed.  
     Nero can then be closed without saving anything.

STEP J:: Stick the label on the CD

  1. Stick the label sticky-side up on the purple thing.

  2. Put the CD upside down on top of the label on the purple thing.

  3. Press the black thing in the middle down firmly.

  4. Take the CD off and make sure the label is fully adhered to the CD.


STEP K: Test

  1. Install Specware 4.1.4

  2. Run the examples & tests.


STEP L: Tag the sources in CVS with the release version (rel-4-1-4)
 	See http://intranet/specware/intranet/cvs-cheatsheet.html 



For Help:

 - Find Jim McDonald or Stephen Westfold for content, 
   or Jeff Kitson for system stuff.
   Call Jim at 408-204-6209 (Cell phone with voice mail)
