How to Create the Specware 4.1 CD (without Accord) (with XEmacs & for Windows) (For public releases)

Last updated: May 31, 2004 by WLP

STEP ONE: Do CVS updates

-       Open WinCVS (Start -> Programs -> WinCVS -> WinCVS)
-       Update the Specware development directory (C:\Specware4)

STEP TWO: Build Specware

-       Move to C:\Specware4\Applications\Specware\bin\windows, and run Specware4.cmd.  If XEmacs
doesn't start up and try to load Specware, edit this file and make sure that the XEmacs
variable is set to the correct version for your system.  If this was a fresh check-out, and 
you are asked, "Continue waiting for ACL to startup (y/n)?" answer 'n'.  
-       Do M-x build-specware4-from-base
-	Do M-x bootstrap-specware4


STEP THREE: Start Specware, and create the distribution directory
-       Delete the C:\Specware4\distribution directory, if it already exists.
-       Go to C:\Specware4\Applications\Specware\bin\windows
-       Double-click Specware4.cmd
-       Open C:\Specware4\Applications\Specware\Handwritten\Lisp\BuildRuntime.lisp for editing in XEmacs.
-	Change the "Specware-version-name" variable(s) to the correct thing.
-	Switch back to the Specware shell, and type 
	       :cd Specware4/Applications/Specware/Handwritten/Lisp
-       Then type
	       :ld BuildRuntime.lisp
-       This will create a distribution directory under Specware4/ that contains the Allegro stuff
needed to run Specware as a stand-alone application, as well as the necessary subdirectories
(e.g. Documentation, Example, Library, etc.).  Stephen Westfold wrote BuildRuntime.lisp and 
knows more.


STEP FOUR: Copy distribution directory to location where InstallShield is expecting it
-	Copy the Specware4 directory under C:\Specware4\distribution\, and paste it in 
	      C:\SpecwareReleases\Specware4-2\Specware\distribution-Allegro\Windows.
-	(TODO: fix the lisp function to do this automatically in BuildRuntime) 
	Copy and rename empty-patch-template.fasl from C:\Specware4\Release\Windows\Patches\ 
to C:\SpecwareReleases\Specware4-2\Specware\distribution-Allegro\Windows\Specware4\Patches


STEP FIVE: Create the InstallShield package
-	Open InstallShield (Start -> Programs -> InstallShield -> Developer)
-       Click on "Open a project..." in the left side panel.
-	Select "Specware-Template.ism", and click Open.
-	Go to File -> Save As and save this project under C:\InstallShield Setups as Specware-4-2.
-       Change the Product Name to be this version of Specware.
-	Change the Version.
-	Click on "Application Data/Files and Folders" in the left side panel.
-	In the frame labeled "Destination computer's folder", expand the "Specware4.1[InstallDir]"
folder.
-	Right-click on "Specware", and select "Dynamic File Linking".
-	Click the "New" button to create a new dynamic link.
-	Enter the path to your new Specware4-2 distribution folder 
C:\SpecwareReleases\Specware4-2\Specware\Specware4.  Check "Include subfolders". Click OK.  This should now
include every file under this directory in the file list.
-	Create 2 shortcuts, one on the desktop and one in the Start menu.
-	Include the license.txt file in the Support Files.
-	Press F7 to build the release package.
-	Go to Tools -> Open Release Folder.  Copy everything in the window that pops up.  Paste 
everything in C:\SpecwareReleases\Specware4-2\Specware\Windows\CD\
-	Edit C:\SpecwareReleases\Specware4-2\Specware\Windows\CD\Autorun.inf to point to Windows/setup.exe instead, and move
that file up one level to C:\SpecwareReleases\Specware4-2\Specware\Windows\CD so that Windows will find it when the CD is 
inserted into the user's machine.- Go to "General Information/Summary Information Stream/Package Code and click the "Generate GUID" button.
-	Change the "General Information/Product Properties/Product Name" to be this version of Specware.
-	Change the "General Information/Product Properties/Version".
-	Click on "Organization/Components" in the left side panel.  Expand the component and click on "Files."
-	Right click in the empty right-hand window and select "Dynamic File Linking".
-	Click the "New Link" button to create a new dynamic link.
-	Enter the path to your new Specware4-2 distribution folder 
C:\SpecwareReleases\Specware4-2\Specware\distribution-Allegro\Windows.  Click OK.  This should now
include every file under this directory in the file list.
-	Click on "System Configuration/Shortcuts" in the left side panel.
-	To add a shortcut, right-click "Desktop" and select "New shortcut to preexisting file".  Type "Specware4.cmd" as the file
name. Add a second shortcut to the same file under "Taskbar/Start Menu/Programs Menu".  Rename both shortcut names as "Specware 4.1".
-       Press F7 to build the release package.
-	Go to Tools -> Open Release Folder.  Copy everything in the window that pops up.  Paste 
everything in C:\SpecwareReleases\Specware4-2\Specware\Windows\CD\


STEP SIX: CREATE LABEL
-       Create a CD label using PowerPoint and/or Paintshop.  Include "Specware", the release date, version,
type of release (Windows), and the copyright jabber.
-       Use the CD LabelMaker software to insert a jpg into the label template.
-       Insert a sheet of the label stickers into P6200, with the label side up.  Print to P6200.


STEP SEVEN: Burn the CD
-	Insert a blank CD into the PlexWriter drive on Core-Win.
-	Open Nero (Start -> Programs -> Ahead Nero -> Nero - Burning Rom)
-	Click Next, Next, Next, Next, Finish through the first wizard that pops up.
-	In the right side window labeled File Browser, move to C:\SpecwareReleases\Specware4-2\Specware\Windows\CD
-	Copy everything in this directory, and paste it into the left side window labeled ISO1.
-	Copy the XEmacs installation folder (I put it on the Desktop for now) to the top level of the CD.
-	Rename the CD from NEW to Specware4-2 by right-clicking the NEW label in the leftmost panel and selecting Rename.
-	Go to File -> Write CD, and then click Burn in the window that pops up.
-	Wait.  Click Done when the burning process is completed.  Nero can be closed without saving anything.


STEP EIGHT: Stick the label on the CD
-	Stick the label sticky-side up on the purple thing.
-	Put the CD upside down on top of the label on the purple thing.
-	Press the black thing in the middle down firmly.
-	Take the CD off and make sure the label is fully adhered to the CD.


STEP NINE: Uninstall previous Specware4.1 (if necessary), Test, and ship to Tim
-	Go to Start -> Settings -> Control Panels
-	Double-click Add/Remove Programs
-	Scroll down to Specware4.1 and click Change/Remove
-	Click ok to uninstall Specware.
-	Install Specware 4.1.x, and run the examples & tests.


STEP TEN: Tag the sources in CVS with the release version (rel-4-2)
-	See http://intranet/specware/intranet/cvs-cheatsheet.html 


HELP STEP:
-       Call Weilyn at 650-996-4041